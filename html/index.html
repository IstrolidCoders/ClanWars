<!DOCTYPE html>
<meta charset="UTF-8">
<html>
    <head>
        <link rel="icon" type="image/png" href="/favicon.png"/>
        <style>
            div.hover {
                height: 1em;
                overflow-y: hidden;
            }
            div.hover:hover {
                height: auto;
            }
        </style>
    </head>
    <body>
        <center>
            <b>Istrolid Battle Records</b>
            <table id="data" border="1">
                <tr>
                    <td>Server</td>
                    <td>Type</td>
                    <td>Alpha</td>
                    <td>Beta</td>
                    <td>Side</td>
                </tr>
            </table>
        </center>
        <script>
            function updateData() {
                var http  = new XMLHttpRequest();
                http.onreadystatechange = () => {
                    if(http.readyState == 4 && http.status == 200) {
                        var rows = http.response;
                        if(Array.isArray(rows)) {
                            let data = ""
                            rows.forEach(e => {
                                data += "<tr><td>" + e.server + "</td><td>" + e.type + "<td><div class=\"hover\">hover<br/>";
                                e.players.filter(p => p.side === "alpha").forEach(e => data += e.name + "<br/>");
                                data += "</div></td><td><div class=\"hover\">hover<br/>"
                                e.players.filter(p => p.side === "beta").forEach(e => data += e.name + "<br/>");
                                data += "</div></td><td>" + e.win + "</td></tr>";
                            });

                            let table = document.getElementById('data');
                            table.insertAdjacentHTML('beforeend', data);
                        } else {
                            console.log("Invalid response");
                        }
                    }
                };
                http.responseType = 'json';
                http.open('GET', "/istrolid", true);
                http.send();
            }
            setInterval(updateData, 30000);
            updateData();
        </script>
    </body>
</html>
